<?xml version="1.0" ?>

<!-- Base elements for Discrete Events System layer. 
     -->

<!DOCTYPE node SYSTEM "/usr/share/grayb/conf/objspec.dtd"> 

<node id="DesComps" parent="Elem">

    <!-- DES logging event -->
    <node id="DesLogevent" parent="Elem" />
    
    <!-- Output socket -->
    <node id="StOutSocket" parent=":Elem:SysComps/Socket">
	<!-- Pin Des observer. Requires DES observer interface to handle activation of the state -->
	<node id="PinObs" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Provided" val="MDesObserver"/>
	</node>
	<!-- Pin Data observer. Provides data interface -->
	<node id="PinData" parent=":Elem:SysComps/ConnPoint"> 
	</node>
    </node>

    <!-- Input socket -->
    <node id="StInpSocket" parent=":Elem:SysComps/Socket">
	<!-- Pin Des observer. Requires DES observer interface to handle activation of the state -->
	<node id="PinObs" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Required" val="MDesObserver"/>
	</node>
	<!-- Pin Data observer. Provides data interface -->
	<node id="PinData" parent=":Elem:SysComps/ConnPoint"> 
	</node>
    </node>

    <!-- Input of standard Int State -->
    <node id="StIntInp" parent=":Elem:SysComps/Extender"> 
	<rm node="Int"/>
	<node id="Int" parent="../StInpSocket"> 
	    <cont node="PinData/Provided" val="MDIntGet"/>
	</node>
    </node>

    <!-- Output of standard Int State -->
    <node id="StIntOut" parent=":Elem:SysComps/Extender"> 
	<rm node="Int"/>
	<node id="Int" parent="../StOutSocket"> 
	    <cont node="PinData/Required" val="MDIntGet"/>
	</node>
    </node>

    <!-- Input of standard variable State -->
    <node id="StVarInp" parent=":Elem:SysComps/Extender"> 
	<rm node="Int"/>
	<node id="Int" parent="../StInpSocket"> 
	    <cont node="PinData/Provided" val="MDVarGet"/>
	</node>
    </node>


    <!-- Input of int transition -->
    <node id="TrIntInp" parent=":Elem:SysComps/ConnPoint"> 
	<cont node="Required" val="MDIntGet"/>
    </node>

    <!-- Input of int transition -->
    <node id="TrVarInp" parent=":Elem:SysComps/ConnPoint"> 
	<cont node="Required" val="MDVarGet"/>
    </node>

    <!-- Transition of integer data -->
    <node id="TrInt" parent="Syst"> 
	<node id="Inp" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Required" val="MDIntGet"/>
	</node>
	<node id="Out" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Provided" val="MDIntGet"/>
	</node>
    </node>

    <!-- Transition of integer data : Increment -->
    <node id="TrIncInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrIncInt"> 
	    </node>
	</add>
    </node>

    <!-- Transition of integer data : Multiplication -->
    <node id="TrMplInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrMplInt"> 
	    </node>
	</add>
    </node>

    <!-- Transition of integer data : Division -->
    <node id="TrDivInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrDivInt"/> 
	</add>
	<node id="Inp_DR" parent="../TrIntInp"/> 
    </node>

    <!-- Transition of integer data : Subtraction -->
    <node id="TrSubInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrSubInt"/> 
	</add>
	<node id="Inp_Sub" parent="../TrIntInp"/> 
    </node>

    <!-- Transition of variable data -->
    <node id="TrVar" parent="Syst"> 
	<node id="Inp" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Required" val="MDVarGet"/>
	</node>
	<node id="Out" parent=":Elem:SysComps/ConnPoint"> 
	    <cont node="Provided" val="MDVarGet"/>
	</node>
	<node id="ViewData" parent="Vert">
	    <node id="Res" parent="Prop"/>
	</node>
    </node>

    <!-- Transition of variable data : Addition -->
    <node id="TrAddVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrAddVar"/> 
	</add>
	<node id="InpN" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/TrAgt"/>
    </node>

    <!-- Transition of variable data : Multiplication -->
    <node id="TrMplVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrMplVar"/> 
	</add>
	<cont node="ViewData/Res" ref="../../Agents/TrAgt"/>
    </node>

    <!-- Transition of variable data : Division -->
    <node id="TrDivVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrDivVar"/> 
	</add>
	<node id="Inp_Dvs" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/TrAgt"/>
    </node>

    <!-- Transition of variable data : Composing vector -->
    <node id="TrCpsVectVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrCpsVectVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp0"/>
	<node id="Inp1" parent="../TrVarInp"/> 
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/TrAgt"/>
    </node>

    <!-- Transition of variable data : Switch -->
    <node id="TrSwitchVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrSwitchVar"/> 
	</add>
	<change node="Inp" attr="id" val="Sel"/>
	<node id="Inp1" parent="../TrVarInp"/> 
	<node id="Inp2" parent="../TrVarInp"/> 
    </node>

    <!-- Transition of variable data : Getting coord of vector -->
    <node id="TrAtVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrAtVar"/> 
	</add>
	<node id="Index" parent="../TrIntInp"/> 
    </node>

    <!-- Transition of variable data : Boolean comparition -->
    <node id="TrLTVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="AF_Lt" parent="ATrBcmpVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp1"/>
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/AF_Lt"/>
    </node>

    <!-- Transition of variable data : Boolean comparition -->
    <node id="TrLEVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="AF_Le" parent="ATrBcmpVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp1"/>
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/AF_Le"/>
    </node>

    <!-- Transition of variable data : Boolean comparition -->
    <node id="TrEQVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="AF_Eq" parent="ATrBcmpVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp1"/>
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/AF_Eq"/>
    </node>

    <!-- Transition of variable data : Boolean comparition -->
    <node id="TrGTVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="AF_Gt" parent="ATrBcmpVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp1"/>
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/AF_Gt"/>
    </node>

    <!-- Transition of variable data : Boolean comparition -->
    <node id="TrGEVar" parent="TrVar"> 
	<add node="Agents"> 
	    <node id="AF_Ge" parent="ATrBcmpVar"/> 
	</add>
	<change node="Inp" attr="id" val="Inp1"/>
	<node id="Inp2" parent="../TrVarInp"/> 
	<cont node="ViewData/Res" ref="../../Agents/AF_Ge"/>
    </node>





    <!-- State base -->
    <node id="State" parent=":Elem:IncapsComps/Incaps"> 

	<add node="Agents"> 
	    <node id="StateAgt" parent="StateAgent"> 
	    </node>
	</add>

	<add node="Capsule">
	    <!-- TODO [YB] Do we need dedicated CP or component has to notify it's mgr? -->
	    <node id="Sync" parent=":Elem:SysComps/ConnPoint"> 
		<cont node="Provided" val="MDesSyncable"/>
	    </node>
	    <!-- Input -->
	    <node id="Inp" parent=":Elem:SysComps/Extender"> 
		<rm node="Int"/>
		<node id="Int" parent="../../../StInpSocket"> 
		</node>
	    </node>
	    <!-- Output -->
	    <node id="Out" parent=":Elem:SysComps/Extender"> 
		<rm node="Int"/>
		<node id="Int" parent="../../../StOutSocket"> 
		</node>
	    </node>
	</add>
    </node>

    <node id="StateInt" parent="State"> 
	<node id="Confirmed" parent=":Elem:DataComps/DataSCInt">
	</node>

	<node id="Prepared" parent=":Elem:DataComps/DataSCInt">
	</node>

	<cont node="Capsule/Inp/Int/PinData/Provided" val="MDIntGet"/>
	<cont node="Capsule/Out/Int/PinData/Required" val="MDIntGet"/>

	<node id="E_Conf_Out" parent="Edge"> 
	    <cont node="P1" val="../../Confirmed/Capsule/Out"/> 
	    <cont node="P2" val="../../Capsule/Out/Int/PinData"/> 
	</node>

	<node id="E_PrepToConf" parent="Edge"> 
	    <cont node="P1" val="../../Prepared/Capsule/Out"/> 
	    <cont node="P2" val="../../Confirmed/Capsule/Inp"/> 
	</node>
    </node>

    <node id="StateVar" parent="State"> 
	<node id="Confirmed" parent=":Elem:DataComps/DataSCVar"/>

	<node id="Prepared" parent=":Elem:DataComps/DataSCVar"/>

	<cont node="Capsule/Inp/Int/PinData/Provided" val="MDVarGet"/>
	<cont node="Capsule/Out/Int/PinData/Required" val="MDVarGet"/>

	<node id="E_Conf_Out" parent="Edge"> 
	    <cont node="P1" ref="../../Confirmed/Capsule/Out"/> 
	    <cont node="P2" ref="../../Capsule/Out/Int/PinData"/> 
	</node>

	<node id="E_PrepToConf" parent="Edge"> 
	    <cont node="P1" ref="../../Prepared/Capsule/Out"/> 
	    <cont node="P2" ref="../../Confirmed/Capsule/Inp"/> 
	</node>
    </node>


    <!-- DES base -->
    <node id="Des" parent=":Elem:IncapsComps/Incaps"> 

	<add node="Agents"> 
	    <node id="DesAgt" parent="ADes"> 
	    </node>
	</add>

	<add node="Capsule">
	    <node id="Sync" parent=":Elem:SysComps/ConnPoint"> 
		<cont node="Provided" val="MDesSyncable"/>
	    </node>
	</add>
    </node>

    <!-- DES ticks source -->
    <node id="DesTicker" parent=":Elem:IncapsComps/Incaps"> 
	<add node="Capsule">
	    <node id="Out" parent=":Elem:SysComps/ConnPoint"> 
		<cont node="Required" val="MDesSyncable"/>
	    </node>
	</add>
	<add node="Agents"> 
	    <node id="DesSyncAgent" parent="ADesSync"> 
	    </node>
	</add>
    </node>


</node>

