<?xml version="1.0" ?>

<!-- Base elements for Discrete Events System layer. 
     -->

<!DOCTYPE node SYSTEM "/usr/share/grayb/conf/objspec.dtd"> 

<node id="DesComps" parent="Elem">

    <!-- DES logging event -->
    <node id="DesLogevent" parent="Elem" />
    
    <!-- Output socket -->
    <node id="StOutSocket" parent="**/(SysComps:)*/Socket">
	<!-- Pin Des observer. Requires DES observer interface to handle activation of the state -->
	<node id="PinObs" parent="**/(SysComps:)*/ConnPoint"> 
	    <cont node="Provided" val="MDesObserver"/>
	</node>
	<!-- Pin Data observer. Provides data interface -->
	<node id="PinData" parent="**/(SysComps:)*/ConnPoint"> 
	</node>
    </node>

    <!-- Input socket -->
    <node id="StInpSocket" parent="**/(SysComps:)*/Socket">
	<!-- Pin Des observer. Requires DES observer interface to handle activation of the state -->
	<node id="PinObs" parent="**/(SysComps:)*/ConnPoint"> 
	    <cont node="Required" val="MDesObserver"/>
	</node>
	<!-- Pin Data observer. Provides data interface -->
	<node id="PinData" parent="**/(SysComps:)*/ConnPoint"> 
	</node>
    </node>

    <!-- Input of standard Int State -->
    <node id="StIntInp" parent="**/(SysComps:)*/Extender"> 
	<rm node="Int"/>
	<node id="Int" parent="../StInpSocket"> 
	    <cont node="PinData/Provided" val="MDIntGet"/>
	</node>
    </node>

    <!-- Output of standard Int State -->
    <node id="StIntOut" parent="**/(SysComps:)*/Extender"> 
	<rm node="Int"/>
	<node id="Int" parent="../StOutSocket"> 
	    <cont node="PinData/Required" val="MDIntGet"/>
	</node>
    </node>

    <!-- Input of int transition -->
    <node id="TrIntInp" parent="**/(SysComps:)*/ConnPoint"> 
	<cont node="Required" val="MDIntGet"/>
    </node>

    <!-- Transition of integer data -->
    <node id="TrInt" parent="Syst"> 
	<node id="Inp" parent="**/(SysComps:)*/ConnPoint"> 
	    <cont node="Required" val="MDIntGet"/>
	</node>
	<node id="Out" parent="**/(SysComps:)*/ConnPoint"> 
	    <cont node="Provided" val="MDIntGet"/>
	</node>
    </node>

    <!-- Transition of integer data : Increment -->
    <node id="TrIncInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrIncInt"> 
	    </node>
	</add>
    </node>

    <!-- Transition of integer data : Multiplication -->
    <node id="TrMplInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrMplInt"> 
	    </node>
	</add>
    </node>

    <!-- Transition of integer data : Division -->
    <node id="TrDivInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrDivInt"/> 
	</add>
	<node id="Inp_DR" parent="../TrIntInp"/> 
    </node>

    <!-- Transition of integer data : Subtraction -->
    <node id="TrSubInt" parent="TrInt"> 
	<add node="Agents"> 
	    <node id="TrAgt" parent="ATrSubInt"/> 
	</add>
	<node id="Inp_Sub" parent="../TrIntInp"/> 
    </node>


    <!-- State base -->
    <node id="State" parent="**/(IncapsComps:)*/Incaps"> 

	<add node="Agents"> 
	    <node id="StateAgt" parent="StateAgent"> 
	    </node>
	</add>

	<add node="Capsule">
	    <!-- TODO [YB] Do we need dedicated CP or component has to notify it's mgr? -->
	    <node id="Sync" parent="**/(SysComps:)*/ConnPoint"> 
		<cont node="Provided" val="MDesSyncable"/>
	    </node>
	    <!-- Input -->
	    <node id="Inp" parent="**/(SysComps:)*/Extender"> 
		<rm node="Int"/>
		<node id="Int" parent="../../../StInpSocket"> 
		</node>
	    </node>
	    <!-- Output -->
	    <node id="Out" parent="**/(SysComps:)*/Extender"> 
		<rm node="Int"/>
		<node id="Int" parent="../../../StOutSocket"> 
		</node>
	    </node>
	</add>
    </node>

    <node id="StateInt" parent="State"> 
	<node id="Confirmed" parent="**/(DataComps:)*/DataSCInt">
	</node>

	<node id="Prepared" parent="**/(DataComps:)*/DataSCInt">
	</node>

	<cont node="Capsule/Inp/Int/PinData/Provided" val="MDIntGet"/>
	<cont node="Capsule/Out/Int/PinData/Required" val="MDIntGet"/>

	<node parent="Edge"> 
	    <cont node="P1" val="Confirmed/Capsule/Out"/> 
	    <cont node="P2" val="Capsule/Out/Int/PinData"/> 
	</node>

	<node parent="Edge"> 
	    <cont node="P1" val="Prepared/Capsule/Out"/> 
	    <cont node="P2" val="Confirmed/Capsule/Inp"/> 
	</node>
    </node>

    <!-- DES base -->
    <node id="Des" parent="**/(IncapsComps:)*/Incaps"> 

	<add node="Agents"> 
	    <node id="DesAgt" parent="ADes"> 
	    </node>
	</add>

	<add node="Capsule">
	    <node id="Sync" parent="**/(SysComps:)*/ConnPoint"> 
		<cont node="Provided" val="MDesSyncable"/>
	    </node>
	</add>
    </node>

    <!-- DES ticks source -->
    <node id="DesTicker" parent="**/(IncapsComps:)*/Incaps"> 
	<add node="Capsule">
	    <node id="Out" parent="**/(SysComps:)*/ConnPoint"> 
		<cont node="Required" val="MDesSyncable"/>
	    </node>
	</add>
	<add node="Agents"> 
	    <node id="DesSyncAgent" parent="ADesSync"> 
	    </node>
	</add>
    </node>


</node>

